<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SpotiStream Configurator</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #fafafa;
      --bg-secondary: #ffffff;
      --panel: #ffffff;
      --panel-hover: #f8f9fa;
      --border: rgba(0, 0, 0, 0.08);
      --border-hover: rgba(0, 0, 0, 0.12);
      --border-light: rgba(0, 0, 0, 0.04);
      --muted: #6b7280;
      --text: #1f2937;
      --text-secondary: #374151;
      --text-light: #9ca3af;
      --accent: #007aff;
      --accent-hover: #0056cc;
      --success: #34c759;
      --warning: #ff9500;
      --danger: #ff3b30;
      --radius: 12px;
      --radius-sm: 8px;
      --radius-lg: 16px;
      --shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }

    * {
      box-sizing: border-box
    }

    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0
    }

    body {
      background: var(--bg);
      color: var(--text);
      font: 400 15px/1.5 -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      overflow-x: hidden;
    }

    .dashboard {
      min-height: 100vh;
      padding: 0;
    }

    .header {
      background: var(--bg-secondary);
      border-bottom: 1px solid var(--border);
      padding: 20px 32px;
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(20px);
    }

    .header-content {
      max-width: 1400px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .header-controls {
      display: flex;
      align-items: center;
      gap: 24px;
    }

    .demo-toggle {
      display: flex;
      align-items: center;
    }

    .toggle-label {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      font-weight: 500;
      color: var(--text);
      font-size: 14px;
    }

    .header h1 {
      margin: 0;
      font-size: 24px;
      font-weight: 600;
      color: var(--text);
    }

    .header-actions {
      display: flex;
      gap: 12px;
      align-items: center;
    }

    .main {
      max-width: 1600px;
      margin: 0 auto;
      padding: 32px;
      display: grid;
      grid-template-columns: 480px 1fr;
      gap: 32px;
      min-height: calc(100vh - 84px);
    }

    .sidebar {
      display: grid;
      grid-template-rows: auto 1fr;
      gap: 24px;
      height: fit-content;
      position: sticky;
      top: 116px;
    }

    .nav-tabs {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 4px;
      background: var(--bg);
      padding: 4px;
      border-radius: var(--radius);
      border: 1px solid var(--border-light);
    }

    .nav-tab {
      appearance: none;
      border: none;
      background: transparent;
      padding: 12px 8px;
      border-radius: var(--radius-sm);
      font-size: 13px;
      font-weight: 500;
      color: var(--text-light);
      cursor: pointer;
      transition: all 0.15s ease;
      text-align: center;
    }

    .nav-tab.active {
      background: var(--bg-secondary);
      color: var(--text);
      box-shadow: var(--shadow);
      font-weight: 600;
    }

    .nav-tab:hover:not(.active) {
      color: var(--text-secondary);
      background: var(--panel-hover);
    }

    .sidebar-content {
      overflow-y: auto;
      overflow-x: hidden;
      max-height: calc(100vh - 200px);
    }

    .sidebar-content::-webkit-scrollbar {
      width: 6px
    }

    .sidebar-content::-webkit-scrollbar-track {
      background: transparent
    }

    .sidebar-content::-webkit-scrollbar-thumb {
      background: var(--border-hover);
      border-radius: 3px
    }

    .sidebar-content::-webkit-scrollbar-thumb:hover {
      background: var(--muted)
    }

    .tab-panel {
      display: none;
      grid-auto-rows: min-content;
      gap: 24px;
    }

    .tab-panel.active {
      display: grid;
    }

    .card {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow);
      transition: all 0.2s ease;
    }

    .card:hover {
      box-shadow: var(--shadow-md);
    }

    .card-header {
      padding: 24px 24px 0 24px;
      border-bottom: 1px solid var(--border-light);
      margin-bottom: 24px;
    }

    .card-title {
      margin: 0 0 16px 0;
      font-size: 18px;
      font-weight: 600;
      color: var(--text);
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .card-title::before {
      content: '';
      width: 4px;
      height: 20px;
      background: linear-gradient(135deg, var(--accent), var(--success));
      border-radius: 2px;
    }

    .card-body {
      padding: 0 24px 24px 24px;
    }

    .form-section {
      display: grid;
      gap: 20px;
      margin-bottom: 32px;
    }

    .form-section:last-child {
      margin-bottom: 0;
    }

    .form-group {
      display: grid;
      gap: 8px;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }

    .form-label {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-secondary);
      margin-bottom: 6px;
    }

    .form-input,
    .form-select {
      width: 100%;
      padding: 12px 16px;
      border-radius: var(--radius);
      background: var(--bg);
      color: var(--text);
      border: 1px solid var(--border);
      font-size: 14px;
      transition: all 0.15s ease;
      font-family: inherit;
    }

    .form-input:focus,
    .form-select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
      background: var(--bg-secondary);
    }

    .range-group {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .range-input {
      flex: 1;
      height: 6px;
      background: var(--bg);
      border-radius: 3px;
      outline: none;
      -webkit-appearance: none;
      border: 1px solid var(--border);
    }

    .range-input::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: var(--accent);
      cursor: pointer;
      box-shadow: var(--shadow);
      transition: all 0.15s ease;
      border: 2px solid var(--bg-secondary);
    }

    .range-input::-webkit-slider-thumb:hover {
      transform: scale(1.1);
      box-shadow: var(--shadow-md);
    }

    .range-value {
      background: var(--bg);
      padding: 6px 12px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      font-size: 12px;
      font-weight: 600;
      color: var(--accent);
      min-width: 60px;
      text-align: center;
    }

    .toggle-group {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
    }

    .toggle {
      appearance: none;
      width: 52px;
      height: 28px;
      background: var(--border);
      border-radius: 14px;
      position: relative;
      outline: none;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
    }

    .toggle:checked {
      background: var(--accent);
    }

    .toggle::after {
      content: "";
      position: absolute;
      top: 2px;
      left: 2px;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: var(--bg-secondary);
      transition: all 0.2s ease;
      box-shadow: var(--shadow);
    }

    .toggle:checked::after {
      left: 26px;
    }

    .color-picker {
      width: 48px;
      height: 48px;
      border: 2px solid var(--border);
      padding: 0;
      border-radius: var(--radius);
      background: var(--bg);
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .color-picker:hover {
      border-color: var(--border-hover);
      transform: scale(1.05);
    }

    .muted {
      opacity: 0.5;
      pointer-events: none;
    }

    .btn {
      appearance: none;
      border: none;
      background: var(--accent);
      color: white;
      font-weight: 500;
      padding: 12px 20px;
      border-radius: var(--radius);
      cursor: pointer;
      font-size: 14px;
      transition: all 0.15s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-family: inherit;
    }

    .btn:hover {
      background: var(--accent-hover);
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }

    .btn-secondary {
      background: var(--success);
    }

    .btn-secondary:hover {
      background: #28a745;
    }

    .btn-outline {
      background: transparent;
      color: var(--text-secondary);
      border: 1px solid var(--border);
    }

    .btn-outline:hover {
      background: var(--bg);
      border-color: var(--border-hover);
      color: var(--text);
      transform: none;
    }

    .btn-sm {
      padding: 8px 12px;
      font-size: 13px;
    }

    .preset-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 8px;
      margin-top: 12px;
    }

    .preset-btn {
      padding: 10px 12px;
      font-size: 12px;
      font-weight: 500;
    }

    .url-display {
      font-family: 'SF Mono', ui-monospace, Menlo, Consolas, monospace;
      background: var(--bg);
      border: 1px solid var(--border);
      padding: 16px;
      border-radius: var(--radius);
      color: var(--text);
      overflow: auto;
      font-size: 13px;
      line-height: 1.4;
      word-break: break-all;
    }

    .preview-area {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow);
      display: grid;
      grid-template-rows: auto 1fr;
      min-height: 600px;
    }

    .preview-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 24px;
      border-bottom: 1px solid var(--border-light);
    }

    .preview-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--text);
      margin: 0;
    }

    .preview-subtitle {
      font-size: 13px;
      color: var(--text-light);
      margin: 4px 0 0 0;
    }

    .preview-content {
      padding: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .preview-iframe {
      width: 100%;
      height: 400px;
      border: none;
      border-radius: var(--radius);
      background: #000;
    }

    .badge {
      font-size: 12px;
      color: var(--text-light);
      font-weight: 500;
    }

    .divider {
      height: 1px;
      background: var(--border-light);
      margin: 24px 0;
    }

    @media (max-width: 1200px) {
      .main {
        grid-template-columns: 1fr;
        gap: 24px;
      }

      .sidebar {
        position: static;
      }

      .preview-area {
        min-height: 400px;
      }
    }
  </style>
</head>

<body>
  <div class="dashboard">
    <header class="header">
      <div class="header-content">
        <h1>SpotiStream Configurator</h1>
        <div class="header-controls">
          <div class="demo-toggle">
            <label class="toggle-label">
              <input id="demo" type="checkbox" class="toggle" checked />
              <span class="toggle-text">Demo Mode</span>
            </label>
          </div>
          <div class="header-actions">
            <button id="copy" class="btn btn-sm">Copy URL</button>
            <button id="open" class="btn-secondary btn-sm">Open Preview</button>
            <button id="reset" class="btn-outline btn-sm">Reset</button>
          </div>
        </div>
      </div>
    </header>

    <main class="main">
      <aside class="sidebar">
        <nav class="nav-tabs">
          <button class="nav-tab active" data-tab="basic">Basic</button>
          <button class="nav-tab" data-tab="visual">Visual</button>
          <button class="nav-tab" data-tab="content">Content</button>
          <button class="nav-tab" data-tab="advanced">Advanced</button>
        </nav>

        <div class="sidebar-content">
          <div class="tab-panel active" id="basic-tab">
            <div class="card">
              <div class="card-header">
                <h2 class="card-title">Quick Start</h2>
              </div>
              <div class="card-body">
                <div class="form-section">
                  <div class="form-group">
                    <label class="form-label">Base URL</label>
                    <input id="base" class="form-input" type="url"
                      placeholder="https://alebirra.github.io/spotify-obs/overlay-test.html"
                      value="https://alebirra.github.io/spotify-obs/overlay-test.html" />
                  </div>

                  <div class="form-group">
                    <label class="form-label">Quick Presets</label>
                    <div class="preset-grid">
                      <button class="btn-outline btn-sm preset-btn" data-preset="record">Record</button>
                      <button class="btn-outline btn-sm preset-btn" data-preset="card">Card</button>
                      <button class="btn-outline btn-sm preset-btn" data-preset="bar">Bar</button>
                      <button class="btn-outline btn-sm preset-btn" data-preset="stacked">Stacked</button>
                      <button class="btn-outline btn-sm preset-btn" data-preset="transparent">Transparent</button>
                      <button class="btn-outline btn-sm preset-btn" data-preset="gaming">Gaming</button>
                      <button class="btn-outline btn-sm preset-btn" data-preset="lofi">Lo-Fi</button>
                      <button class="btn-outline btn-sm preset-btn" data-preset="cyberpunk">Cyberpunk</button>
                      <button class="btn-outline btn-sm preset-btn" data-preset="elegant">Elegant</button>
                      <button class="btn-outline btn-sm preset-btn" data-preset="party">Party</button>
                      <button class="btn-outline btn-sm preset-btn" data-preset="cozy">Cozy</button>
                      <button class="btn-outline btn-sm preset-btn" data-preset="streamer">Streamer</button>
                      <button class="btn-outline btn-sm preset-btn" data-preset="focus">Focus</button>
                      <button class="btn-outline btn-sm preset-btn" data-preset="ultraminimal">Ultra Minimal</button>
                    </div>
                  </div>

                  <div class="divider"></div>

                  <div class="form-group">
                    <label class="form-label">Generated URL</label>
                    <div id="url" class="url-display"></div>
                    <div class="badge">Copy this URL into OBS â†’ Browser Source</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="card-header">
                <h2 class="card-title">Layout & Style</h2>
              </div>
              <div class="card-body">
                <div class="form-section">
                  <div class="form-row">
                    <div class="form-group">
                      <label class="form-label">Layout</label>
                      <select id="layout" class="form-select">
                        <option value="record">Record (Vinyl)</option>
                        <option value="card">Card (Cover)</option>
                        <option value="bar">Bar (Minimal)</option>
                        <option value="stacked">Stacked (Center)</option>
                        <option value="compact">Compact (Mini)</option>
                        <option value="wide">Wide (Cinematic)</option>
                        <option value="split">Split (Dual)</option>
                        <option value="floating">Floating (Overlay)</option>
                        <option value="corner">Corner (Tiny)</option>
                        <option value="ticker">Ticker (Scroll)</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label class="form-label">Media Position</label>
                      <select id="align" class="form-select">
                        <option value="left">Left</option>
                        <option value="right">Right</option>
                        <option value="center">Center</option>
                        <option value="top">Top</option>
                        <option value="bottom">Bottom</option>
                      </select>
                    </div>
                  </div>

                  <div class="form-row">
                    <div class="form-group">
                      <label class="form-label">Theme</label>
                      <select id="theme" class="form-select">
                        <option value="spotify">Spotify</option>
                        <option value="obsdark">OBS Dark</option>
                        <option value="minimal">Minimal</option>
                        <option value="neon">Neon</option>
                        <option value="gaming">Gaming</option>
                        <option value="lofi">Lo-Fi</option>
                        <option value="retro">Retro Wave</option>
                        <option value="elegant">Elegant</option>
                        <option value="cyberpunk">Cyberpunk</option>
                        <option value="sunset">Sunset</option>
                        <option value="ocean">Ocean</option>
                        <option value="forest">Forest</option>
                        <option value="midnight">Midnight</option>
                        <option value="aurora">Aurora</option>
                        <option value="gradient">Gradient</option>
                        <option value="monochrome">Monochrome</option>
                        <option value="party">Party</option>
                        <option value="cozy">Cozy</option>
                        <option value="focus">Focus</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label class="form-label">Accent Style</label>
                      <select id="accentstyle" class="form-select">
                        <option value="solid">Solid</option>
                        <option value="glow">Glow</option>
                        <option value="gradient">Gradient</option>
                        <option value="pulse">Pulse</option>
                        <option value="rainbow">Rainbow</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="card-header">
                <h2 class="card-title">Sizing & Positioning</h2>
              </div>
              <div class="card-body">
                <div class="form-section">
                  <div class="form-row">
                    <div class="form-group">
                      <label class="form-label">Media Size</label>
                      <div class="range-group">
                        <input id="disc" class="range-input" type="range" min="120" max="360" step="2" value="200"
                          oninput="discOut.textContent=this.value" />
                        <div class="range-value"><span id="discOut">200</span>px</div>
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="form-label">Progress Height</label>
                      <div class="range-group">
                        <input id="bar" class="range-input" type="range" min="0" max="16" step="1" value="6"
                          oninput="barOut.textContent=this.value" />
                        <div class="range-value"><span id="barOut">6</span>px</div>
                      </div>
                    </div>
                  </div>

                  <div class="form-row">
                    <div class="form-group">
                      <label class="form-label">Title Size</label>
                      <div class="range-group">
                        <input id="titlesize" class="range-input" type="range" min="14" max="64" step="1" value="24"
                          oninput="tsOut.textContent=this.value" />
                        <div class="range-value"><span id="tsOut">24</span>px</div>
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="form-label">Artist Size</label>
                      <div class="range-group">
                        <input id="artistsize" class="range-input" type="range" min="10" max="32" step="1" value="15"
                          oninput="asOut.textContent=this.value" />
                        <div class="range-value"><span id="asOut">15</span>px</div>
                      </div>
                    </div>
                  </div>

                  <div class="form-row">
                    <div class="form-group">
                      <label class="form-label">Progress Width</label>
                      <div class="range-group">
                        <input id="progressWidth" class="range-input" type="range" min="50" max="100" step="5"
                          value="100" oninput="progWidthOut.textContent=this.value" />
                        <div class="range-value"><span id="progWidthOut">100</span>%</div>
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="form-label">Corner Radius</label>
                      <div class="range-group">
                        <input id="radius" class="range-input" type="range" min="0" max="24" step="1" value="16"
                          oninput="radOut.textContent=this.value" />
                        <div class="range-value"><span id="radOut">16</span>px</div>
                      </div>
                    </div>
                  </div>

                  <div class="form-row">
                    <div class="form-group">
                      <label class="form-label">Blur</label>
                      <div class="range-group">
                        <input id="blur" class="range-input" type="range" min="0" max="16" step="1" value="8"
                          oninput="blurOut.textContent=this.value" />
                        <div class="range-value"><span id="blurOut">8</span>px</div>
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="form-label">Safe Padding</label>
                      <div class="range-group">
                        <input id="pad" class="range-input" type="range" min="0" max="32" step="1" value="16"
                          oninput="padOut.textContent=this.value" />
                        <div class="range-value"><span id="padOut">16</span>px</div>
                      </div>
                    </div>
                  </div>

                  <div class="form-row">
                    <div class="form-group">
                      <label class="form-label">Title Outline</label>
                      <div class="range-group">
                        <input id="outline" class="range-input" type="range" min="0" max="2" step="1" value="0"
                          oninput="outlineOut.textContent=this.value" />
                        <div class="range-value"><span id="outlineOut">0</span>px</div>
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="form-label">Text Alignment</label>
                      <select id="textAlign" class="form-select">
                        <option value="auto">Auto (follows media)</option>
                        <option value="left">Left</option>
                        <option value="center">Center</option>
                        <option value="right">Right</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="card-header">
                <h2 class="card-title">Behavior</h2>
              </div>
              <div class="card-body">
                <div class="form-section">
                  <div class="toggle-group">
                    <label class="form-label">Compact spacing</label>
                    <input id="compact" type="checkbox" class="toggle" />
                  </div>
                  <div class="toggle-group">
                    <label class="form-label">Spin while playing</label>
                    <input id="spin" type="checkbox" class="toggle" checked />
                  </div>
                  <div class="toggle-group">
                    <label class="form-label">Keep label upright</label>
                    <input id="labelStatic" type="checkbox" class="toggle" />
                  </div>
                  <div class="toggle-group">
                    <label class="form-label">Show tonearm (record)</label>
                    <input id="tonearm" type="checkbox" class="toggle" checked />
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="tab-panel" id="visual-tab">
            <div class="card">
              <div class="card-header">
                <h2 class="card-title">Visual Effects</h2>
              </div>
              <div class="card-body">
                <div class="form-section">
                  <div class="toggle-group">
                    <label class="form-label">Particle Effects</label>
                    <input id="particles" type="checkbox" class="toggle" />
                  </div>
                  <div class="toggle-group">
                    <label class="form-label">Color Breathing</label>
                    <input id="colorBreathing" type="checkbox" class="toggle" />
                  </div>
                  <div class="toggle-group">
                    <label class="form-label">Waveform Visualizer</label>
                    <input id="waveform" type="checkbox" class="toggle" />
                  </div>
                  <div class="toggle-group">
                    <label class="form-label">Album Blur Background</label>
                    <input id="albumBlur" type="checkbox" class="toggle" />
                  </div>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="card-header">
                <h2 class="card-title">Animations</h2>
              </div>
              <div class="card-body">
                <div class="form-section">
                  <div class="form-row">
                    <div class="form-group">
                      <label class="form-label">Track Change Effect</label>
                      <select id="transitionEffect" class="form-select">
                        <option value="none">None</option>
                        <option value="slide">Slide</option>
                        <option value="fade">Fade</option>
                        <option value="bounce">Bounce</option>
                        <option value="zoom">Zoom</option>
                        <option value="flip">Flip</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label class="form-label">Animation Speed</label>
                      <div class="range-group">
                        <input id="animSpeed" class="range-input" type="range" min="0.5" max="2" step="0.1" value="1"
                          oninput="animSpeedOut.textContent=this.value" />
                        <div class="range-value"><span id="animSpeedOut">1</span>x</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="tab-panel" id="content-tab">
            <div class="card">
              <div class="card-header">
                <h2 class="card-title">Elements</h2>
              </div>
              <div class="card-body">
                <div class="form-section">
                  <div class="toggle-group">
                    <label class="form-label">Status pill</label>
                    <input id="showStatus" type="checkbox" class="toggle" checked />
                  </div>
                  <div class="toggle-group">
                    <label class="form-label">Progress bar</label>
                    <input id="showProgress" type="checkbox" class="toggle" checked />
                  </div>
                  <div class="toggle-group">
                    <label class="form-label">Time (elapsed/total)</label>
                    <input id="showTime" type="checkbox" class="toggle" checked />
                  </div>
                  <div class="toggle-group">
                    <label class="form-label">Title</label>
                    <input id="showTitle" type="checkbox" class="toggle" checked />
                  </div>
                  <div class="toggle-group">
                    <label class="form-label">Artist</label>
                    <input id="showArtist" type="checkbox" class="toggle" checked />
                  </div>
                  <div class="toggle-group">
                    <label class="form-label">Show Next (stacked)</label>
                    <input id="showNext" type="checkbox" class="toggle" />
                  </div>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="card-header">
                <h2 class="card-title">Text & Motion</h2>
              </div>
              <div class="card-body">
                <div class="form-section">
                  <div class="toggle-group">
                    <label class="form-label">Scroll long text</label>
                    <input id="scroll" type="checkbox" class="toggle" checked />
                  </div>
                  <div class="toggle-group">
                    <label class="form-label">Auto-accent from album art</label>
                    <input id="autoAccent" type="checkbox" class="toggle" />
                  </div>
                  <div class="form-group">
                    <label class="form-label">Marquee Speed</label>
                    <div class="range-group">
                      <input id="marq" class="range-input" type="range" min="8" max="30" step="1" value="18"
                        oninput="marqOut.textContent=this.value" />
                      <div class="range-value"><span id="marqOut">18</span>s</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="tab-panel" id="advanced-tab">
            <div class="card">
              <div class="card-header">
                <h2 class="card-title">Typography</h2>
              </div>
              <div class="card-body">
                <div class="form-section">
                  <div class="form-row">
                    <div class="form-group">
                      <label class="form-label">Font</label>
                      <select id="font" class="form-select">
                        <option value="">(default)</option>
                        <option value="inter">Inter</option>
                        <option value="rubik">Rubik</option>
                        <option value="montserrat">Montserrat</option>
                        <option value="poppins">Poppins</option>
                        <option value="firasans">Fira Sans</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label class="form-label">Text Shadow</label>
                      <select id="shadow" class="form-select">
                        <option value="1">On</option>
                        <option value="0">Off</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="card-header">
                <h2 class="card-title">Colors & Custom</h2>
              </div>
              <div class="card-body">
                <div class="form-section">
                  <div class="form-row">
                    <div class="form-group">
                      <label class="form-label">Color Mode</label>
                      <select id="colorMode" class="form-select">
                        <option value="theme">Theme</option>
                        <option value="custom">Custom</option>
                      </select>
                    </div>
                  </div>
                  <div id="colorsBlock" class="form-section">
                    <div class="form-row">
                      <div class="form-group">
                        <label class="form-label">Accent Color</label>
                        <input id="accent" type="color" class="color-picker" value="#1db954" />
                      </div>
                      <div class="form-group">
                        <label class="form-label">Text Color</label>
                        <input id="text" type="color" class="color-picker" value="#eaeaea" />
                      </div>
                    </div>
                    <div class="form-row">
                      <div class="form-group">
                        <label class="form-label">Muted Color</label>
                        <input id="muted" type="color" class="color-picker" value="#b6bcc4" />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="card-header">
                <h2 class="card-title">Background</h2>
              </div>
              <div class="card-body">
                <div class="form-section">
                  <div class="toggle-group">
                    <label class="form-label">Transparent panel</label>
                    <input id="transparent" type="checkbox" class="toggle" />
                  </div>
                  <div class="form-group">
                    <label class="form-label">Panel Opacity</label>
                    <div class="range-group">
                      <input id="panelAlpha" class="range-input" type="range" min="0" max="100" step="1" value="72"
                        oninput="paOut.textContent=this.value" />
                      <div class="range-value"><span id="paOut">72</span>%</div>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="form-label">Panel Color</label>
                    <input id="panelColor" type="color" class="color-picker" value="#121212" />
                  </div>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="card-header">
                <h2 class="card-title">Quick Actions</h2>
              </div>
              <div class="card-body">
                <div class="form-section">
                  <button id="transparentPreset" class="btn-outline">1-click Transparent</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </aside>

      <section class="preview-area">
        <div class="preview-header">
          <div>
            <h2 class="preview-title">Live Preview</h2>
            <p class="preview-subtitle">Turn off demo mode to connect to Spotify</p>
          </div>
          <div class="badge">Resize to test different scales</div>
        </div>
        <div class="preview-content">
          <iframe id="preview" class="preview-iframe" src="" allow="clipboard-read; clipboard-write"></iframe>
        </div>
      </section>
    </main>
  </div>

  <script>
    const $ = id => document.getElementById(id);
    const els = {
      base: $('base'), layout: $('layout'), align: $('align'), theme: $('theme'), accentstyle: $('accentstyle'),
      disc: $('disc'), bar: $('bar'), progressWidth: $('progressWidth'), textAlign: $('textAlign'),
      titlesize: $('titlesize'), artistsize: $('artistsize'),
      radius: $('radius'), blur: $('blur'), pad: $('pad'), outline: $('outline'),
      compact: $('compact'), spin: $('spin'), labelStatic: $('labelStatic'), tonearm: $('tonearm'),
      showStatus: $('showStatus'), showProgress: $('showProgress'), showTime: $('showTime'),
      showTitle: $('showTitle'), showArtist: $('showArtist'), showNext: $('showNext'),
      scroll: $('scroll'), autoAccent: $('autoAccent'), marq: $('marq'),
      particles: $('particles'), colorBreathing: $('colorBreathing'), waveform: $('waveform'),
      albumBlur: $('albumBlur'), transitionEffect: $('transitionEffect'), animSpeed: $('animSpeed'),

      font: $('font'), shadow: $('shadow'), colorMode: $('colorMode'), accent: $('accent'), text: $('text'), muted: $('muted'),
      transparent: $('transparent'), panelAlpha: $('panelAlpha'), panelColor: $('panelColor'),
      demo: $('demo'), transparentPreset: $('transparentPreset'),
      url: $('url'), copy: $('copy'), open: $('open'), reset: $('reset'), preview: $('preview'),
      colorsBlock: $('colorsBlock')
    };

    // Presets
    document.querySelectorAll('[data-preset]').forEach(btn => {
      btn.addEventListener('click', () => {
        const p = btn.dataset.preset;
        const defSizes = { titlesize: 24, artistsize: 15 };
        if (p === 'record') { setState({ layout: 'record', align: 'left', theme: 'spotify', accentstyle: 'solid', disc: 200, progressWidth: 100, textAlign: 'auto', compact: 0, spin: 1, labelStatic: 0, tonearm: 1, showStatus: 1, showProgress: 1, showTime: 1, showTitle: 1, showArtist: 1, showNext: 0, particles: 0, colorBreathing: 0, waveform: 0, albumBlur: 0, transitionEffect: 'none', animSpeed: 1, ...defSizes }); }
        if (p === 'card') { setState({ layout: 'card', align: 'left', theme: 'obsdark', accentstyle: 'solid', disc: 220, progressWidth: 100, textAlign: 'auto', compact: 0, spin: 1, labelStatic: 0, tonearm: 0, showStatus: 1, showProgress: 1, showTime: 1, showTitle: 1, showArtist: 1, showNext: 0, particles: 0, colorBreathing: 0, waveform: 0, albumBlur: 0, transitionEffect: 'none', animSpeed: 1, ...defSizes }); }
        if (p === 'bar') { setState({ layout: 'bar', align: 'left', theme: 'minimal', accentstyle: 'solid', disc: 0, progressWidth: 100, textAlign: 'left', compact: 1, spin: 0, labelStatic: 0, tonearm: 0, showStatus: 0, showProgress: 1, showTime: 1, showTitle: 1, showArtist: 1, showNext: 0, particles: 0, colorBreathing: 0, waveform: 0, albumBlur: 0, transitionEffect: 'none', animSpeed: 1, titlesize: 16, artistsize: 13 }); }
        if (p === 'stacked') { setState({ layout: 'stacked', align: 'center', theme: 'elegant', accentstyle: 'solid', disc: 180, progressWidth: 100, textAlign: 'center', compact: 0, spin: 1, labelStatic: 0, tonearm: 1, showStatus: 1, showProgress: 1, showTime: 1, showTitle: 1, showArtist: 1, showNext: 0, particles: 0, colorBreathing: 0, waveform: 0, albumBlur: 0, transitionEffect: 'none', animSpeed: 1, ...defSizes }); }
        if (p === 'transparent') { setState({ layout: 'card', align: 'left', theme: 'minimal', accentstyle: 'solid', disc: 200, progressWidth: 100, textAlign: 'auto', compact: 0, spin: 1, labelStatic: 0, tonearm: 0, showStatus: 1, showProgress: 1, showTime: 1, showTitle: 1, showArtist: 1, showNext: 0, particles: 0, colorBreathing: 0, waveform: 0, albumBlur: 0, transitionEffect: 'none', animSpeed: 1, transparent: 1, ...defSizes }); }
        if (p === 'gaming') { setState({ layout: 'compact', align: 'right', theme: 'gaming', accentstyle: 'glow', disc: 200, progressWidth: 100, textAlign: 'auto', compact: 0, spin: 1, labelStatic: 0, tonearm: 0, showStatus: 0, showProgress: 1, showTime: 1, showTitle: 1, showArtist: 1, showNext: 0, particles: 1, colorBreathing: 1, waveform: 0, albumBlur: 0, transitionEffect: 'slide', animSpeed: 1.2, titlesize: 20, artistsize: 13 }); }
        if (p === 'lofi') { setState({ layout: 'wide', align: 'center', theme: 'lofi', accentstyle: 'solid', disc: 160, progressWidth: 80, textAlign: 'center', compact: 0, spin: 1, labelStatic: 0, tonearm: 0, showStatus: 1, showProgress: 1, showTime: 1, showTitle: 1, showArtist: 1, showNext: 0, particles: 0, colorBreathing: 1, waveform: 0, albumBlur: 1, transitionEffect: 'fade', animSpeed: 0.8, ...defSizes }); }
        if (p === 'cyberpunk') { setState({ layout: 'floating', align: 'right', theme: 'cyberpunk', accentstyle: 'gradient', disc: 140, progressWidth: 100, textAlign: 'left', compact: 0, spin: 1, labelStatic: 0, tonearm: 0, showStatus: 1, showProgress: 1, showTime: 1, showTitle: 1, showArtist: 1, showNext: 0, particles: 1, colorBreathing: 1, waveform: 1, albumBlur: 0, transitionEffect: 'slide', animSpeed: 1.5, ...defSizes }); }
        if (p === 'elegant') { setState({ layout: 'split', align: 'center', theme: 'elegant', accentstyle: 'solid', disc: 200, progressWidth: 90, textAlign: 'center', compact: 0, spin: 1, labelStatic: 0, tonearm: 0, showStatus: 1, showProgress: 1, showTime: 1, showTitle: 1, showArtist: 1, showNext: 0, particles: 0, colorBreathing: 0, waveform: 0, albumBlur: 1, transitionEffect: 'fade', animSpeed: 1, ...defSizes }); }
        if (p === 'party') { setState({ layout: 'ticker', align: 'left', theme: 'party', accentstyle: 'glow', disc: 60, progressWidth: 100, textAlign: 'left', compact: 0, spin: 1, labelStatic: 0, tonearm: 0, showStatus: 0, showProgress: 0, showTime: 0, showTitle: 1, showArtist: 1, showNext: 0, particles: 1, colorBreathing: 1, waveform: 1, albumBlur: 0, transitionEffect: 'bounce', animSpeed: 2, titlesize: 28, artistsize: 18 }); }
        if (p === 'cozy') { setState({ layout: 'corner', align: 'right', theme: 'cozy', accentstyle: 'solid', disc: 60, progressWidth: 100, textAlign: 'right', compact: 1, spin: 1, labelStatic: 0, tonearm: 0, showStatus: 0, showProgress: 0, showTime: 0, showTitle: 1, showArtist: 1, showNext: 0, particles: 0, colorBreathing: 1, waveform: 0, albumBlur: 1, transitionEffect: 'fade', animSpeed: 0.7, titlesize: 16, artistsize: 12 }); }
        if (p === 'streamer') { setState({ layout: 'floating', align: 'right', theme: 'neon', accentstyle: 'glow', disc: 120, progressWidth: 100, textAlign: 'left', compact: 0, spin: 1, labelStatic: 0, tonearm: 0, showStatus: 1, showProgress: 1, showTime: 1, showTitle: 1, showArtist: 1, showNext: 0, particles: 0, colorBreathing: 0, waveform: 0, albumBlur: 0, transitionEffect: 'none', animSpeed: 1, ...defSizes }); }
        if (p === 'focus') { setState({ layout: 'compact', align: 'left', theme: 'focus', accentstyle: 'solid', disc: 80, progressWidth: 100, textAlign: 'left', compact: 1, spin: 0, labelStatic: 0, tonearm: 0, showStatus: 0, showProgress: 1, showTime: 1, showTitle: 1, showArtist: 1, showNext: 0, particles: 0, colorBreathing: 0, waveform: 0, albumBlur: 0, transitionEffect: 'none', animSpeed: 1, titlesize: 18, artistsize: 12 }); }
        if (p === 'ultraminimal') { setState({ layout: 'bar', align: 'left', theme: 'monochrome', accentstyle: 'solid', disc: 0, progressWidth: 60, textAlign: 'left', compact: 1, spin: 0, labelStatic: 0, tonearm: 0, showStatus: 0, showProgress: 0, showTime: 0, showTitle: 1, showArtist: 0, showNext: 0, particles: 0, colorBreathing: 0, waveform: 0, albumBlur: 0, transitionEffect: 'none', animSpeed: 1, titlesize: 14, artistsize: 10 }); }
        render();
      });
    });

    function setState(s) {
      for (const k in s) {
        if (els[k] && 'value' in els[k]) els[k].value = s[k];
        if (els[k] && 'checked' in els[k]) els[k].checked = !!s[k];
      }
      render();
    }

    function getState() {
      return {
        base: els.base.value.trim(),
        layout: els.layout.value, align: els.align.value, theme: els.theme.value, accentstyle: els.accentstyle.value,
        disc: els.disc.value, bar: els.bar.value, progressWidth: els.progressWidth.value, textAlign: els.textAlign.value,
        titlesize: els.titlesize.value, artistsize: els.artistsize.value,
        radius: els.radius.value, blur: els.blur.value, pad: els.pad.value, outline: els.outline.value,
        compact: +els.compact.checked, spin: +els.spin.checked, labelStatic: +els.labelStatic.checked, tonearm: +els.tonearm.checked,
        showStatus: +els.showStatus.checked, showProgress: +els.showProgress.checked, showTime: +els.showTime.checked,
        showTitle: +els.showTitle.checked, showArtist: +els.showArtist.checked, showNext: +els.showNext.checked,
        scroll: +els.scroll.checked, autoAccent: +els.autoAccent.checked, marq: els.marq.value,
        particles: +(els.particles?.checked || false), colorBreathing: +(els.colorBreathing?.checked || false),
        waveform: +(els.waveform?.checked || false), albumBlur: +(els.albumBlur?.checked || false),
        transitionEffect: els.transitionEffect?.value || 'none', animSpeed: els.animSpeed?.value || 1,

        font: els.font.value, shadow: els.shadow.value, colorMode: els.colorMode.value,
        accent: els.accent.value, text: els.text.value, muted: els.muted.value,
        transparent: +els.transparent.checked, panelAlpha: els.panelAlpha.value, panelColor: els.panelColor.value,
        demo: +els.demo.checked
      };
    }

    function buildURL() {
      const s = getState(); if (!s.base) return '';
      const q = new URLSearchParams();

      if (s.layout && s.layout !== 'record') q.set('layout', s.layout);
      if (s.align && s.align !== 'left') q.set('align', s.align);
      if (s.theme) q.set('theme', s.theme);
      if (s.accentstyle && s.accentstyle !== 'solid') q.set('accentstyle', s.accentstyle);
      if (s.disc) q.set('disc', s.disc);
      if (s.bar) q.set('bar', s.bar);
      if (s.progressWidth && s.progressWidth !== '100') q.set('progresswidth', s.progressWidth);
      if (s.titlesize) q.set('titlesize', s.titlesize);
      if (s.artistsize) q.set('artistsize', s.artistsize);
      if (s.textAlign && s.textAlign !== 'auto') q.set('textalign', s.textAlign);
      if (s.radius) q.set('radius', s.radius);
      if (s.blur) q.set('blur', s.blur);
      if (s.pad) q.set('pad', s.pad);
      if (s.outline) q.set('outline', s.outline);
      if (s.compact) q.set('compact', '1');
      if (!s.spin) q.set('spin', '0');
      if (s.labelStatic) q.set('label', 'static');
      if (!s.tonearm) q.set('tonearm', '0');
      if (!s.showStatus) q.set('showstatus', '0');
      if (!s.showProgress) q.set('showprogress', '0');
      if (!s.showTime) q.set('showtime', '0');
      if (!s.showTitle) q.set('title', '0');
      if (!s.showArtist) q.set('artist', '0');
      if (s.showNext) q.set('next', '1');
      if (!s.scroll) q.set('scroll', '0');
      if (s.autoAccent) q.set('autoaccent', '1');
      if (s.marq && s.marq !== '18') q.set('marq', s.marq);
      if (s.particles) q.set('particles', '1');
      if (s.colorBreathing) q.set('colorbreathing', '1');
      if (s.waveform) q.set('waveform', '1');
      if (s.albumBlur) q.set('albumblur', '1');
      if (s.transitionEffect && s.transitionEffect !== 'none') q.set('transition', s.transitionEffect);
      if (s.animSpeed && s.animSpeed !== '1') q.set('animspeed', s.animSpeed);

      if (s.font) q.set('font', s.font);
      if (s.shadow === '0') q.set('shadow', '0');
      if (s.colorMode === 'custom') {
        if (s.accent) q.set('accent', s.accent);
        if (s.text) q.set('text', s.text);
        if (s.muted) q.set('muted', s.muted);
      }
      if (s.transparent) q.set('transparent', '1');
      else {
        const hexToRgb = hex => {
          const m = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex) || [];
          return { r: parseInt(m[1] || '00', 16), g: parseInt(m[2] || '00', 16), b: parseInt(m[3] || '00', 16) };
        };
        const { r, g, b } = hexToRgb(s.panelColor);
        const a = Math.max(0, Math.min(100, parseInt(s.panelAlpha || '72', 10))) / 100;
        q.set('panel', `rgba(${r},${g},${b},${a})`);
      }

      const sep = s.base.includes('?') ? '&' : '?';
      return s.base + (q.toString() ? sep + q.toString() : '');
    }

    function render() {
      const u = buildURL();
      els.url.textContent = u;

      // Add demo parameter to preview URL only (not to the generated URL)
      // Add timestamp to force iframe reload when parameters change
      const timestamp = Date.now();
      const previewUrl = u + (u.includes('?') ? '&' : '?') + 'demo=1&_t=' + timestamp;
      const finalUrl = els.demo.checked ? previewUrl : (u + (u.includes('?') ? '&' : '?') + '_t=' + timestamp);
      
      els.preview.src = finalUrl;
    }

    // Tab switching
    document.querySelectorAll('.nav-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-panel').forEach(c => c.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(tab.dataset.tab + '-tab').classList.add('active');
      });
    });

    // Wire up events
    for (const k in els) {
      const n = els[k]; if (!n) continue;
      if (n.tagName === 'INPUT' || n.tagName === 'SELECT') {
        n.addEventListener('input', render);
        n.addEventListener('change', render);
      }
    }

    els.copy.onclick = async () => {
      try {
        await navigator.clipboard.writeText(els.url.textContent);
        els.copy.textContent = 'Copied!';
        setTimeout(() => els.copy.textContent = 'Copy URL', 1200);
      } catch (e) { }
    };

    els.open.onclick = () => {
      if (els.url.textContent) window.open(els.url.textContent, '_blank');
    };

    els.reset.onclick = () => {
      location.reload();
    };

    els.transparentPreset.onclick = () => {
      els.transparent.checked = true;
      els.blur.value = 0;
      els.radius.value = 0;
      els.pad.value = 0;
      els.shadow.value = '0';
      render();
    };

    function toggleColorsBlock() {
      const custom = els.colorMode.value === 'custom';
      els.colorsBlock.classList.toggle('muted', !custom);
    }

    els.colorMode.addEventListener('change', toggleColorsBlock);
    toggleColorsBlock();

    // Initial render
    render();
  </script>
</body>

</html>

